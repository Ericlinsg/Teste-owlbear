<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">

<title>HP HUD</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: transparent;
  font-family: Arial, sans-serif;
}

#hud {
  width: 150px;
  padding: 8px;
  background: rgba(25,25,25,0.9);
  border-radius: 10px;
  border: 1px solid #555;
  box-shadow: 0 0 10px rgba(0,0,0,0.8);
}

#label {
  text-align: center;
  font-size: 12px;
  margin-bottom: 4px;
  font-weight: bold;
}

#barOuter {
  width: 100%;
  height: 14px;
  background: #333;
  border-radius: 7px;
  overflow: hidden;
}

#barInner {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #c00, #0f0);
  transition: width 0.4s ease;
}

#numbers {
  text-align: center;
  font-size: 11px;
  margin-top: 4px;
}
</style>
</head>

<body>

<div id="hud">
  <div id="label">HP</div>

  <div id="barOuter">
    <div id="barInner"></div>
  </div>

  <div id="numbers">-- / --</div>
</div>

<script>
const SHEET_ID = "15KcUk2EmTfuEzxtvHK8wNXlcxv5htuh_";
const GID = 1636579447;

// BG = coluna 59 | BP = coluna 67
// BG6 -> row 5 | BP12 -> row 11

async function getCell(col, row) {

  const query = encodeURIComponent(
    `select ${col} where row=${row}`
  );

  const url =
    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?` +
    `gid=${GID}&tqx=out:json&tq=${query}`;

  const res = await fetch(url);
  const txt = await res.text();

  const json = JSON.parse(
    txt.substring(txt.indexOf("{"), txt.lastIndexOf("}") + 1)
  );

  return json.table.rows[0]?.c[0]?.v ?? 0;
}

async function refreshHUD() {

  try {
    const hpNow = await getCell("BG", 5);
    const hpMax = await getCell("BP", 11);

    const pct = hpMax > 0 ? hpNow / hpMax : 0;

    document.getElementById("barInner").style.width =
      Math.min(100, pct * 100) + "%";

    document.getElementById("numbers").innerText =
      hpNow + " / " + hpMax;

  } catch (e) {
    console.error("Erro HUD:", e);
  }
}

// inicializa
refreshHUD();

// atualiza a cada 5 segundos
setInterval(refreshHUD, 5000);
</script>

</body>
</html>
